<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Configuração de Performance</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>

    <style>
        body { background-color: #0f172a; color: white; font-family: 'Inter', sans-serif; overflow-x: hidden; }
        .glass { background: rgba(30, 41, 59, 0.7); backdrop-filter: blur(12px); border: 1px solid rgba(255, 255, 255, 0.1); }
        .input-box { width: 100%; background: #000; border: 1px solid #334155; border-radius: 1rem; padding: 14px; color: white; outline: none; transition: 0.3s; }
        .input-box:focus { border-color: #3b82f6; box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.2); }
        
        /* Notificação Profissional */
        #toast {
            position: fixed; top: -100px; left: 50%; transform: translateX(-50%);
            background: #10b981; color: white; padding: 16px 32px; border-radius: 50px;
            font-weight: 900; text-transform: uppercase; font-size: 12px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.3); transition: 0.5s cubic-bezier(0.18, 0.89, 0.32, 1.28);
            z-index: 9999; display: flex; align-items: center; gap: 10px;
        }
        #toast.show { top: 30px; }
    </style>
</head>
<body class="p-4 pb-20">

    <div id="toast"><i class="fas fa-check-circle"></i> Meta Salva com Sucesso!</div>

    <div class="max-w-md mx-auto space-y-6">
        <header class="text-center py-6 relative">
            <button onclick="window.location.href='index.html'" class="absolute left-0 top-1/2 -translate-y-1/2 p-2 text-gray-500 hover:text-white">
                <i class="fas fa-arrow-left text-xl"></i>
            </button>
            <h1 class="text-blue-500 font-black text-[10px] uppercase tracking-widest">Configuração Individual</h1>
            <h2 class="text-2xl font-black uppercase italic">Meus Objetivos</h2>
        </header>

        <!-- IDENTIFICAÇÃO -->
        <div class="glass p-6 rounded-[2.5rem] border-l-4 border-blue-500 shadow-2xl">
            <label class="text-[9px] text-blue-400 font-black uppercase tracking-tighter">ID do Vendedor no Banco</label>
            <input type="text" id="vendedor-id" class="input-box uppercase mt-1 font-bold text-sm" placeholder="SEU NOME NO SISTEMA">
        </div>

        <!-- NÍVEIS DE META -->
        <div class="space-y-4">
            <!-- NÍVEL 1 -->
            <div class="glass p-6 rounded-[2.5rem] border-l-4 border-green-500">
                <h3 class="text-green-500 font-black text-[10px] uppercase mb-4 tracking-widest">Nível 01 - Bronze</h3>
                <div class="space-y-3">
                    <div><label class="text-[9px] text-gray-500 font-bold uppercase">Amarração (R$)</label><input type="number" id="n1-amarracao" class="input-box text-center"></div>
                    <div class="grid grid-cols-2 gap-3">
                        <div><label class="text-[9px] text-gray-500 font-bold uppercase">Imper (R$)</label><input type="number" id="n1-imper" class="input-box text-center"></div>
                        <div><label class="text-[9px] text-gray-500 font-bold uppercase">Assist (R$)</label><input type="number" id="n1-assist" class="input-box text-center"></div>
                    </div>
                </div>
            </div>

            <!-- NÍVEL 2 -->
            <div class="glass p-6 rounded-[2.5rem] border-l-4 border-blue-500">
                <h3 class="text-blue-500 font-black text-[10px] uppercase mb-4 tracking-widest">Nível 02 - Prata</h3>
                <div class="space-y-3">
                    <div><label class="text-[9px] text-gray-500 font-bold uppercase">Amarração (R$)</label><input type="number" id="n2-amarracao" class="input-box text-center"></div>
                    <div class="grid grid-cols-2 gap-3">
                        <div><label class="text-[9px] text-gray-500 font-bold uppercase">Imper (R$)</label><input type="number" id="n2-imper" class="input-box text-center"></div>
                        <div><label class="text-[9px] text-gray-500 font-bold uppercase">Assist (R$)</label><input type="number" id="n2-assist" class="input-box text-center"></div>
                    </div>
                </div>
            </div>
            
            <!-- NÍVEL 3 -->
            <div class="glass p-6 rounded-[2.5rem] border-l-4 border-amber-500">
                <h3 class="text-amber-500 font-black text-[10px] uppercase mb-4 tracking-widest">Nível 03 - Ouro</h3>
                <div class="space-y-3">
                    <div><label class="text-[9px] text-gray-500 font-bold uppercase">Amarração (R$)</label><input type="number" id="n3-amarracao" class="input-box text-center"></div>
                    <div class="grid grid-cols-2 gap-3">
                        <div><label class="text-[9px] text-gray-500 font-bold uppercase">Imper (R$)</label><input type="number" id="n3-imper" class="input-box text-center"></div>
                        <div><label class="text-[9px] text-gray-500 font-bold uppercase">Assist (R$)</label><input type="number" id="n3-assist" class="input-box text-center"></div>
                    </div>
                </div>
            </div>
        </div>

        <button onclick="salvarMetas()" class="w-full bg-blue-600 text-white font-black py-5 rounded-2xl uppercase text-xs shadow-xl active:scale-95 transition-all">
            Salvar Meta de Performance
        </button>
    </div>

    <script>
        // COLOQUE SUAS CHAVES DO FIREBASE AQUI
        const firebaseConfig = { apiKey: "...", authDomain: "...", projectId: "...", storageBucket: "...", messagingSenderId: "...", appId: "..." };
        if (!firebase.apps.length) firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        window.onload = () => {
            const salvas = JSON.parse(localStorage.getItem('metas_individuais_v35'));
            if(salvas) {
                document.getElementById('vendedor-id').value = salvas.vendedor || '';
                for(let n=1; n<=3; n++) {
                    ['amarracao', 'imper', 'assist'].forEach(c => {
                        if(salvas[`nivel${n}`]) document.getElementById(`n${n}-${c}`).value = salvas[`nivel${n}`][c] || '';
                    });
                }
            }
        };

        async function salvarMetas() {
            const vendedor = document.getElementById('vendedor-id').value.toUpperCase();
            if(!vendedor) { alert("IDENTIFIQUE SEU USUÁRIO"); return; }

            const dados = {
                vendedor: vendedor,
                nivel1: { amarracao: document.getElementById('n1-amarracao').value, imper: document.getElementById('n1-imper').value, assist: document.getElementById('n1-assist').value },
                nivel2: { amarracao: document.getElementById('n2-amarracao').value, imper: document.getElementById('n2-imper').value, assist: document.getElementById('n2-assist').value },
                nivel3: { amarracao: document.getElementById('n3-amarracao').value, imper: document.getElementById('n3-imper').value, assist: document.getElementById('n3-assist').value },
                timestamp: firebase.firestore.FieldValue.serverTimestamp()
            };

            try {
                await db.collection("Metas_Individuais").doc(vendedor).set(dados);
                localStorage.setItem('metas_individuais_v35', JSON.stringify(dados));
                
                const toast = document.getElementById('toast');
                toast.classList.add('show');
                setTimeout(() => { window.location.href = 'index.html'; }, 2000);
            } catch (e) { console.error(e); }
        }
    </script>
</body>
</html>
